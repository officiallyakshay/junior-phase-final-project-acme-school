<html>
<head>
  <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/Faker/3.1.0/faker.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.js'></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-router-dom/5.0.1/react-router-dom.js"></script>  
  <!-- <link rel = 'stylesheet' href = 'styles.css'> -->
<style>
  .form {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  nav {
    display: flex;
    padding: 1rem;
    background-color: dodgerblue;
    text-decoration: none;
    color: white;
  }
</style>
</head>
<body>
  <div id='root'></div>
  <script type='text/babel'>
    const { render } = ReactDOM;
    const { createElement, Component } = React;
    const { HashRouter, Link, Route, Switch, Redirect, NavLink } = ReactRouterDOM;
    
    const Nav = ({ schools, students }) => {
      const links = [
        { text: `Schools (${schools.length})`, to: '/schools' },
        { text: `Students (${students.length})`, to: '/students' },
        { text: `Most Popular ()`, to: '/' },
        { text: `Top School ()`, to: '/' },
      ];
      return (
        <nav>
          <a href='/'>Acme School</a>
            <div>
              {
                links.map( link=> <NavLink key={ link.text } to={ link.to }>{ link.text }</NavLink>)
              }
            </div>
        </nav>
      );
    }

    const Home = () => {
      return (
        <div>
          <form className='form'>
            First Name <input />
            Last Name <input />
            Email <input />
            GPA <input />
            Enroll At <select>
              <option value="--Not Enrolled--">--Not Enrolled--</option>
              <option value="MIT">MIT</option>
              <option value="Harvard">Harvard</option>
              <option value="Cal Poly">Cal Poly</option>
              <option value="UC Berkeley">UC Berkeley</option>
              {
                // ^ grab form thru api / database instead of hardcoding ^
              }
            </select>
            <button>Save</button>
          </form>
          <h1>Home</h1>
          <p>Our most popular school is <a></a> with students.</p>
          <p>Our top performing school is <a></a> with an average GPA of</p>
        </div>
      );
    }

    const Schools = ({ schools }) => {
      return (
        <div>
          <form className='form'>
            First Name <input />
            Last Name <input />
            Email <input />
            GPA <input />
            Enroll At <select>
              <option value="--Not Enrolled--">--Not Enrolled--</option>
              <option value="MIT">MIT</option>
              <option value="Harvard">Harvard</option>
              <option value="Cal Poly">Cal Poly</option>
              <option value="UC Berkeley">UC Berkeley</option>
            </select>
            <button>Save</button>
          </form>
          <ul>
            {
              schools.map(school => <li key={school.id}>{school.name}</li>)
            }
          </ul>
        </div>
      );
    }

    const Students = ({ students, schools, onChange, onSubmit, destroy }) => {
      // console.log(students)
      return (
        <div>
          <form className='form'>
            First Name <input name='firstName' onChange = { onChange } />
            Last Name <input name='lastName'  onChange = { onChange } />
            Email <input name='email'  onChange = { onChange } />
            GPA <input name='gpa'  onChange = { onChange } />
            Enroll At <select>
              <option value="--Not Enrolled--">--Not Enrolled--</option>
                {
                  schools.map(school => <option key={school.id}>{school.name}</option>)
                }
            </select>
            <button onClick = { onSubmit } >Save</button>
          </form>
          <ul>
            {
              students.map(student => <li key={student.id}>{student.firstName} {student.lastName} GPA:{student.gpa}<button onClick = { () => destroy(student.id) } >Destroy</button></li>)
            }
          </ul>
        </div>
      );
    }

    class App extends Component {
      constructor() {
        super();
        this.state = {
          schools: [],
          students: []
        }
        this.onChange = this.onChange.bind(this);
        this.onSubmit = this.onSubmit.bind(this);
        this.destroy = this.destroy.bind(this);
      }
      // need an onChange so u can grab the values within the form
      // refer to thomas' notes he sent u on slack
      async onSubmit(ev) {
        ev.preventDefault();
        const payload = {firstName: this.state.firstName, lastName: this.state.lastName, gpa: this.state.gpa, email: this.state.email}
        const student = (await axios.post('/students', payload)).data;
        const students = [...this.state.students, student];
        // console.log(student, 'hi', students)
        this.setState({ students });
        // console.log(this.state)
      }
      onChange(ev) {
        // console.log('hi', {[ev.target.name]: ev.target.value})
        this.setState({[ev.target.name]: ev.target.value})
      }
      async destroy(id) {
        await axios.delete(`/students/${id}`);
        this.setState({ students : this.state.students.filter( student => student.id !== id ) })
      }
      async componentDidMount() {
        const urls = [
          '/schools',
          '/students'
        ];
        const [ schools, students ] = await Promise.all(
          urls.map( url => axios.get(url).then( response => response.data))
        );
        this.setState({ schools, students });
      }
      render() {
        return (
          <HashRouter>
            <Route render = { () => <Nav { ...this.state } /> } />
              <div className='container'>
                <Route exact path='/' render = { () => <Home { ...this.state }  /> } />
                <Route path='/schools' render={ () => <Schools { ...this.state } onChange = { this.onChange } onSubmit = { this.onSubmit } destroy = { this.destroy } /> } />
                <Route path='/students' render={ ()=> <Students { ...this.state } onChange = { this.onChange } onSubmit = { this.onSubmit } destroy = { this.destroy } /> } />
                  {
                // <Route path='/schools:id' render={()=> <Schools />} />
                  }
              </div>
          </HashRouter>
        );
      }
    }

      const root = document.querySelector('#root');
      render(< App />, root)
    </script>
    <!-- <header>
      <a href='#'>Acme Schools</a>
      <nav>
        <a href='#' class='selected'>Schools</a>
        <a href='#'>Students</a>
        <a href='#'>Most Popular</a>
        <a href='#'>Top School</a>
      </nav>
    </header>
    <div id='content'>
      <h1>Users</h1>
      <form>
        <h1>Create A User</h1>
        <div>
          <label>First Name</label>
          <input placeholder='Jane' />
        </div>
        <div>
          <label>Last Name</label>
          <input placeholder='Doe' />
        </div>
        <div>
          <label>Department</label>
          <select>
            <option value=''>-- None --</option>
            <option value=''>Administration</option>
            <option value=''>Human Resources</option>
            <option value=''>Engineering</option>
          </select>
        </div>
        <div class='button-row'>
          <button>Clear</button>
          <button class='primary'>Save</button>
        </div>
      </form>
      <div class='tiles'>
        <div>
          <h4>User A</h4>
          <div>Some text for the user</div>
        </div>
        <div>
          <h4>User A</h4>
          <div>
            Some text for the user.
            Some text for the user.
            Some text for the user.
            Some text for the user.
            Some text for the user.
            Some text for the user.
          </div>
        </div>
        <div>
          <h4>User A</h4>
          <div>Some text for the user</div>
        </div>
        <div>
          <h4>User A</h4>
          <div>Some text for the user</div>
        </div>
        <div>
          <h4>User A</h4>
          <div>Some text for the user</div>
        </div>
        <div>
          <h4>User A</h4>
          <div>Some text for the user</div>
        </div>
        <div>
          <h4>User A</h4>
          <div>Some text for the user</div>
        </div>
      </div>
    </div> -->
  </body>
</html>