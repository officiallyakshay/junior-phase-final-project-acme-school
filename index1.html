<html>
<head>
  <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/Faker/3.1.0/faker.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.js'></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-router-dom/5.0.1/react-router-dom.js"></script>  
  <!-- <link rel = 'stylesheet' href = 'styles.css'> -->
<style>
  .form {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  nav {
    display: flex;
    padding: 1rem;
    background-color: dodgerblue;
    text-decoration: none;
    color: white;
  }
</style>
</head>
<body>
  <div id='root'></div>
  <script type='text/babel'>
    const { render } = ReactDOM;
    const { createElement, Component } = React;
    const { HashRouter, Link, Route, Switch, Redirect, NavLink } = ReactRouterDOM;





    // const MostPopular = () => {
      //gonna be some for loop to decide what school has the most students? map? 
    // }

    // const TopSchool = () => {
      //gonna be some for loop to decide what school has the highest gpa? map?  
    // }

    class App extends Component {
      constructor() {
        super();
        this.state = {
          schools: [],
          students: []
        }
        this.onChange = this.onChange.bind(this);
        this.onSubmit = this.onSubmit.bind(this);
        this.destroy = this.destroy.bind(this);
      }
      // need an onChange so u can grab the values within the form
      // refer to thomas' notes he sent u on slack
      async onSubmit(ev) {
        ev.preventDefault();
        const payload = {firstName: this.state.firstName, lastName: this.state.lastName, gpa: this.state.gpa, email: this.state.email, schoolId: this.state.schoolId}
        const student = (await axios.post('/students', payload)).data;
        const students = [...this.state.students, student];
        this.setState({ students });
      }
      onChange(ev) {
        this.setState({[ev.target.name]: ev.target.value});
      }
      async destroy(id) {
        await axios.delete(`/students/${id}`);
        this.setState({ students : this.state.students.filter( student => student.id !== id ) })
      }
      async componentDidMount() {
        const urls = [
          '/schools',
          '/students'
        ];
        const [ schools, students ] = await Promise.all(
          urls.map( url => axios.get(url).then( response => response.data))
        );
        this.setState({ schools, students });
      }
      render() {
        return (
          <HashRouter>
            <Route render = { () => <Nav { ...this.state } /> } />
              <div className='container'>
                <Route exact path='/' render = { () => <Home { ...this.state }  /> } />
                <Route exact path='/schools' render={ () => <Schools { ...this.state } onChange = { this.onChange } onSubmit = { this.onSubmit } destroy = { this.destroy } /> } />
                <Route path='/students' render={ ()=> <Students { ...this.state } onChange = { this.onChange } onSubmit = { this.onSubmit } destroy = { this.destroy } /> } />
                <Route path='/schools/:id' render={ ({ match })=> <RespectiveSchool schoolId = { match.params.id } { ...this.state } onChange = { this.onChange } onSubmit = { this.onSubmit } destroy = { this.destroy } /> } />
              </div>
          </HashRouter>
        );
      }
    }

      const root = document.querySelector('#root');
      render(< App />, root)
    </script>
    <!-- <header>
      <a href='#'>Acme Schools</a>
      <nav>
        <a href='#' class='selected'>Schools</a>
        <a href='#'>Students</a>
        <a href='#'>Most Popular</a>
        <a href='#'>Top School</a>
      </nav>
    </header>
    <div id='content'>
      <h1>Users</h1>
      <form>
        <h1>Create A User</h1>
        <div>
          <label>First Name</label>
          <input placeholder='Jane' />
        </div>
        <div>
          <label>Last Name</label>
          <input placeholder='Doe' />
        </div>
        <div>
          <label>Department</label>
          <select>
            <option value=''>-- None --</option>
            <option value=''>Administration</option>
            <option value=''>Human Resources</option>
            <option value=''>Engineering</option>
          </select>
        </div>
        <div class='button-row'>
          <button>Clear</button>
          <button class='primary'>Save</button>
        </div>
      </form>
      <div class='tiles'>
        <div>
          <h4>User A</h4>
          <div>Some text for the user</div>
        </div>
        <div>
          <h4>User A</h4>
          <div>
            Some text for the user.
            Some text for the user.
            Some text for the user.
            Some text for the user.
            Some text for the user.
            Some text for the user.
          </div>
        </div>
        <div>
          <h4>User A</h4>
          <div>Some text for the user</div>
        </div>
        <div>
          <h4>User A</h4>
          <div>Some text for the user</div>
        </div>
        <div>
          <h4>User A</h4>
          <div>Some text for the user</div>
        </div>
        <div>
          <h4>User A</h4>
          <div>Some text for the user</div>
        </div>
        <div>
          <h4>User A</h4>
          <div>Some text for the user</div>
        </div>
      </div>
    </div> -->
  </body>
</html>